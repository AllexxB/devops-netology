# Домашнее задание к занятию 12.8 "Резервное копирование баз данных"

---

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надежность работы БД и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1 Необходимо восстанавливать данные в полном объеме за предыдущий день.

***необходимо настроить полное резервное копирование раз в сутки***

1.2 Необходимо восстанавливать данные за час до предполагаемой поломки.

***инкрементный бэкап раз в час***.

1.3* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую/починеную БД?

***не совсем понятна постановка вопроса, но думаю при наличии реплики БД такое возможно***.

---

### Задание 2. PostgreSQL

2.1 С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

* pg_dump mydb > db.sql
* pg_dump -Fc mydb > db.dump

* pg_restore -d newdb db.dump

2.1* Возможно ли автоматизировать этот процесс? Если да, то как?

*автоматизировать процесс бэкапа можно написав скрипт на любом доступном языке и поставив скрипт на выполнение в планировщик. Автоматизировать процесс восстановления тоже можно но скорее всего там нужен будет скрипт с параметрами (например ввод даты или названия файла восстановления.
Пример моего скрипта для бекапа нескольких схем БД Oracle*

```shell 
MD d:\Atoll_Dump\%DATE%
MD d:\Atoll_Dump\LOGS\%DATE%
ECHO "ATOLL_LPWA"
exp system/password@ATOLL FILE=d:\Atoll_Dump\%DATE%\ATOLL_LPWA.dmp LOG=d:\Atoll_Dump\LOGS\%DATE%\ATOLL_LPWA.log OWNER=LPWA ROWS=Y STATISTICS=NONE FEEDBACK=1000

ECHO "ATOLL_WIMAX"
exp system/password@ATOLL FILE=d:\Atoll_Dump\%DATE%\ATOLL_WIMAX.dmp LOG=d:\Atoll_Dump\LOGS\%DATE%\ATOLL_WIMAX.log OWNER=WIMAX ROWS=Y STATISTICS=NONE FEEDBACK=1000

ECHO "ATOLL_VPM"
exp system/password@ATOLL FILE=d:\Atoll_Dump\%DATE%\ATOLL_VPM.dmp LOG=d:\Atoll_Dump\LOGS\%DATE%\ATOLL_VPM.log OWNER=ATOLL_VPM ROWS=Y STATISTICS=NONE FEEDBACK=1000

ECHO "ATOLL_WIFI"
exp system/password@ATOLL FILE=d:\Atoll_Dump\%DATE%\ATOLL_WIFI.dmp LOG=d:\Atoll_Dump\LOGS\%DATE%\ATOLL_WIFI.log OWNER=WIFI ROWS=Y STATISTICS=NONE FEEDBACK=1000
```
---

### Задание 3. MySql

3.1 С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySql.

***например так:
mysqlbackup --defaults-file=/home/dbadmin/my.cnf --incremental --incremental-base=history:last_backup --backup-dir=/home/dbadmin/temp_dir --backup-image=incremental_image1.bi backup-to-image***

3.1* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

***Использование реплики дает возможность увеличить отказоустойчивость системы в случае сбоев недоступности ноды или чего то еще, но если произошла ошибка или ошибочные данные, то эти данные будут и на реплике, поэтому наличие реплики не решает задач резервного копирования***

*Приведите ответ в свободной форме.*

---

Задания,помеченные звездочкой * - дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.
